<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Log in • RevProject</title>
    <link rel="preload" href="fonts/Inter-400.ttf" as="font" type="font/ttf" crossorigin />
    <link rel="preload" href="fonts/Inter-500.ttf" as="font" type="font/ttf" crossorigin />
    <link rel="preload" href="fonts/Inter-600.ttf" as="font" type="font/ttf" crossorigin />
    <link rel="preload" href="fonts/Inter-700.ttf" as="font" type="font/ttf" crossorigin />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body class="is-loading">
    <main class="login-layout">
      <section class="card" id="auth-card">
        <header>
          <h1>Sign in to continue</h1>
          <p class="card-subtitle">
            Use your account email and password to access RevProject. Sessions persist securely with HTTP-only cookies.
          </p>
        </header>

        <form
          hx-post="/auth/login"
          hx-target="#login-message"
          hx-swap="innerHTML"
          hx-indicator="#login-indicator"
          hx-vals="js:{ timezoneOffset: new Date().getTimezoneOffset() }"
        >
          <label>
            Email address
            <input
              type="email"
              name="email"
              class="input-field"
              autocomplete="email"
              required
              placeholder="team@company.com"
            />
          </label>

          <label>
            Password
            <input
              type="password"
              name="password"
              class="input-field"
              autocomplete="current-password"
              required
              minlength="8"
              placeholder="Enter your password"
            />
          </label>

          <div class="form-row">
            <label class="remember-option">
              <input type="checkbox" name="remember" value="true" />
              Remember me
            </label>
            <a href="/forgot-password" class="form-link">Forgot password?</a>
          </div>

          <button type="submit">Log in</button>

          <div id="login-indicator" class="htmx-indicator" aria-live="polite" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="9" stroke-opacity="0.2" />
              <path d="M21 12a9 9 0 0 1-9 9" />
            </svg>
            Authenticating…
          </div>

          <p id="login-message" class="message" aria-live="polite"></p>
        </form>

        <div class="alt-actions">
          <span>Just exploring?</span>
          <a href="/register">Create your workspace</a>
        </div>
      </section>
    </main>
    <script>
      (function () {
        function removeLoadingClass() {
          document.body.classList.remove('is-loading');
        }

        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', removeLoadingClass, {
            once: true,
          });
        } else {
          removeLoadingClass();
        }

        function injectHTMX() {
          if (document.documentElement.dataset.htmxLoaded) return;
          document.documentElement.dataset.htmxLoaded = 'true';
          var script = document.createElement('script');
          script.src = 'https://cdn.jsdelivr.net/npm/htmx.org@2.0.7/dist/htmx.min.js';
          script.integrity = 'sha384-ZBXiYtYQ6hJ2Y0ZNoYuI+Nq5MqWBr+chMrS/RkXpNzQCApHEhOt2aY8EJgqwHLkJ';
          script.crossOrigin = 'anonymous';
          document.head.appendChild(script);
        }

        if ('requestIdleCallback' in window) {
          requestIdleCallback(injectHTMX);
        } else {
          window.addEventListener('load', injectHTMX, { once: true });
        }
      })();
    </script>
  </body>
</html>
